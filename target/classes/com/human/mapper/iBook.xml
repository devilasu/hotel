<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.human.mapper.iBook">
	<insert id="insertReservation">
		insert into reservation(
			bookcode,
			startdate,
			enddate,
			howmany,
			mobile,
			roomcode
		) values(
		#{bookcode},
		#{startdate},
		#{enddate},
		#{howmany},
		#{mobile},
		#{roomcode}
		)
	</insert>
	
	<select id="getReservation" parameterType="com.human.vo.ReservTypeInfo" resultType="com.human.vo.Roominfo">
	<![CDATA[
	
		select *
		from room
		where 
			type = #{roomType}
			and (select A.roomcode 
   			from room A, reservation B
   			where A.roomcode=B.roomcode 
   			and (startdate <= #{endDate} and enddate >= #{startDate})) != room.roomcode
	]]>
	</select>
	
	<select id="getReservated" parameterType="com.human.vo.ReservTypeInfo" resultType="com.human.vo.Roominfo">
	<![CDATA[
	
		select *
		from room
		where 
			type = #{roomType}
			and (select A.roomcode 
   			from room A, reservation B
   			where A.roomcode=B.roomcode
   			and (startdate <= #{endDate} and enddate >= #{startDate})) == room.roomcode
	]]>
	</select>
</mapper>